(this["webpackJsonparound-react"]=this["webpackJsonparound-react"]||[]).push([[0],{28:function(e,t,n){},38:function(e,t,n){"use strict";n.r(t);var a=n(1),o=n.n(a),c=n(17),i=n.n(c),s=(n(28),n(22)),r=n(2),l=n(3),u=n.p+"static/media/logo.4e8e0a1d.svg",d=n(8),m=n(0);var j=function(e){var t=e.email,n=e.link,a=e.linkText,o=e.onLogOut,c=Object(l.h)().pathname;return"/signin"===c?(a="Sign up",n="/signup"):"/signup"===c?(a="Log in",n="/signin"):"/"===c&&(a="Log out",n="/signin"),Object(m.jsxs)("header",{className:"header",children:[Object(m.jsx)("img",{className:"header__logo",src:u,alt:"Around The World"}),Object(m.jsxs)("div",{className:"header__menu",children:[Object(m.jsx)("p",{className:"header__menu-item",children:t}),Object(m.jsx)(d.b,{className:"header__menu-item",to:n,onClick:o,children:a})]})]})},h=o.a.createContext();var b=function(e){var t,n=o.a.useContext(h),a=null===(t=e.card.likes)||void 0===t?void 0:t.some((function(e){return e===(null===n||void 0===n?void 0:n._id)})),c="elements__like ".concat(a?"elements__like_active":""),i=e.card.owner===(null===n||void 0===n?void 0:n._id),s="elements__delete-button ".concat(i?"elements__delete-button":"elements__delete-button_hidden");return Object(m.jsxs)("li",{className:"elements__item",children:[Object(m.jsx)("img",{className:"elements__image",alt:e.card.name,src:e.card.link,onClick:function(){e.onCardClick(e.card)}}),Object(m.jsx)("button",{className:s,type:"button","aria-label":"trash button",onClick:function(){e.onCardDelete(e.card)}}),Object(m.jsxs)("div",{className:"elements__heading",children:[Object(m.jsx)("h2",{className:"elements__title",children:e.card.name}),Object(m.jsxs)("div",{className:"elements__like-container",children:[Object(m.jsx)("button",{className:c,type:"button","aria-label":"like button",onClick:function(){e.onCardLike(e.card)}}),Object(m.jsx)("p",{className:"elements__like-counter",children:e.card.likes.length})]})]})]})};var p=function(e){var t=o.a.useContext(h);return Object(m.jsxs)("main",{className:"content",children:[Object(m.jsxs)("section",{className:"profile",children:[Object(m.jsxs)("div",{className:"profile__avatar",children:[Object(m.jsx)("img",{className:"profile__image",src:t.avatar,alt:"Avatar"}),Object(m.jsx)("button",{className:"profile__image-edit",onClick:e.onEditAvatarClick})]}),Object(m.jsxs)("div",{className:"profile__content",children:[Object(m.jsxs)("div",{className:"profile__details",children:[Object(m.jsx)("h1",{className:"profile__name",children:t.name}),Object(m.jsx)("button",{type:"button","aria-label":"edit button",className:"profile__edit",onClick:e.onEditProfileClick})]}),Object(m.jsx)("p",{className:"profile__occupation",children:t.about})]}),Object(m.jsx)("button",{className:"profile__add",type:"button","aria-label":"add button",onClick:e.onAddPlaceClick})]}),Object(m.jsx)("section",{className:"elements",children:Object(m.jsx)("ul",{className:"elements__container",children:e.cards.map((function(t){return Object(m.jsx)(b,{card:t,likes:t.likes.length,onCardClick:e.onCardClick,onCardLike:e.onCardLike,onCardDelete:e.onCardDelete},t._id)}))})})]})};var _=function(){return Object(m.jsx)("footer",{className:"footer",children:Object(m.jsx)("p",{className:"footer__author",children:"\xa9 2021 Around The U.S."})})};var f=function(e){return Object(m.jsx)("div",{className:"modal modal_type_".concat(e.name," ").concat(e.isOpen?"modal_opened":""),children:Object(m.jsxs)("div",{className:"modal__container",children:[Object(m.jsxs)("form",{className:"modal__form modal__form_type_".concat(e.name),name:e.name,onSubmit:e.onSubmit,children:[Object(m.jsx)("h3",{className:"modal__title",children:e.title}),e.children,Object(m.jsx)("button",{className:"modal__form-submit",type:"submit","aria-label":"save button",children:e.buttonText})]}),Object(m.jsx)("button",{className:"modal__close-button",type:"button","aria-label":"close button",onClick:e.onClose})]})})};var O=function(e){var t=o.a.useState(),n=Object(r.a)(t,2),a=n[0],c=n[1],i=o.a.useState(),s=Object(r.a)(i,2),l=s[0],u=s[1];return Object(m.jsxs)(f,{name:"create",title:"New place",buttonText:"Create",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onAddPlace({name:a,link:l}),c(""),u("")},children:[Object(m.jsx)("input",{id:"placeTitle",className:"modal__form-control modal__form-control_input_title",type:"text",placeholder:"Title",name:"titleInput",required:!0,minLength:"1",maxLength:"30",value:a,onChange:function(e){c(e.target.value)}}),Object(m.jsx)("span",{id:"placeTitle-error",className:"modal__error"}),Object(m.jsx)("input",{id:"placeLink",className:"modal__form-control modal__form-control_input_image",type:"url",placeholder:"Image Link",name:"imageLinkInput",required:!0,value:l,onChange:function(e){u(e.target.value)}}),Object(m.jsx)("span",{id:"placeLink-error",className:"modal__error"})]})};var g=function(e){var t=o.a.useRef();return Object(m.jsxs)(f,{name:"avatar",title:"Change Profile Picture",buttonText:"Save",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(n){n.preventDefault(),e.onUpdateAvatar({avatar:t.current.value})},children:[Object(m.jsx)("input",{ref:t,id:"avatar-url",className:"modal__form-control modal__form-control_avatar",type:"url",placeholder:"Image Link",name:"avatarInput",required:!0}),Object(m.jsx)("span",{id:"avatar-url-error",className:"modal__error"})]})};var x=function(e){var t=o.a.useContext(h),n=o.a.useState(""),a=Object(r.a)(n,2),c=a[0],i=a[1],s=o.a.useState(""),l=Object(r.a)(s,2),u=l[0],d=l[1];return o.a.useEffect((function(){i(t.name),d(t.about)}),[t,e.isOpen]),Object(m.jsxs)(f,{name:"edit",title:"Edit Profile",buttonText:"Save",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:c,about:u})},children:[Object(m.jsx)("input",{value:c||"",id:"profileName",className:"modal__form-control modal__form-control_input_name",type:"text",placeholder:"Name",name:"profileNameInput",required:!0,minLength:"2",maxLength:"40",onChange:function(e){i(e.target.value)}}),Object(m.jsx)("span",{id:"profileName-error",className:"modal__error"}),Object(m.jsx)("input",{value:u||"",id:"profileOccupation",className:"modal__form-control modal__form-control_input_occupation",type:"text",placeholder:"Occupation",name:"profileOccupationInput",required:!0,minLength:"2",maxLength:"200",onChange:function(e){d(e.target.value)}}),Object(m.jsx)("span",{id:"profileOccupation-error",className:"modal__error"})]})};var v=function(e){return Object(m.jsx)(f,{name:"deleteConfirmation",title:"Are you sure?",buttonText:"Yes",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onSubmit(e.cardToDelete)}})};var k=function(e){var t,n,a;return Object(m.jsx)("div",{className:"modal modal_type_image ".concat(e.card?"modal_opened":""),children:Object(m.jsxs)("div",{className:"modal__container modal__container_preview",children:[Object(m.jsx)("button",{className:"modal__close-button  modal__close-button_preview",type:"button","aria-label":"close button",onClick:e.onClose}),Object(m.jsxs)("figure",{children:[Object(m.jsx)("img",{className:"modal__image",src:null===(t=e.card)||void 0===t?void 0:t.link,alt:null===(n=e.card)||void 0===n?void 0:n.name}),Object(m.jsx)("figcaption",{className:"modal__image-title",children:null===(a=e.card)||void 0===a?void 0:a.name})]})]})})},C=function(e){var t=o.a.useState(""),n=Object(r.a)(t,2),a=n[0],c=n[1],i=o.a.useState(""),s=Object(r.a)(i,2),l=s[0],u=s[1];return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(j,{link:"/signup",linkText:"Sign up"}),Object(m.jsx)("div",{className:"modal__form_container",children:Object(m.jsxs)("form",{className:"modal__form",onSubmit:function(t){t.preventDefault(),e.handleLogin(a,l)},children:[Object(m.jsx)("h3",{className:"modal__form_heading",children:"Log in"}),Object(m.jsx)("input",{className:"modal__form_input",placeholder:"Email",type:"email",name:"email",minLength:2,maxLength:200,value:a,onChange:function(e){return c(e.target.value)},required:!0}),Object(m.jsx)("input",{className:"modal__form_input",placeholder:"Password",type:"password",name:"password",minLength:2,maxLength:200,value:l,onChange:function(e){return u(e.target.value)},required:!0}),Object(m.jsx)("button",{className:"modal__form_submit",type:"submit",children:"Log In"}),Object(m.jsx)(d.b,{className:"modal__link",to:"/signup",children:"Not a member yet? Sign up here!"})]})})]})},N=n(16),y=n(23),S=["children","loggedIn"];var L=function(e){var t=e.children,n=e.loggedIn,a=Object(y.a)(e,S);return Object(m.jsx)(l.b,Object(N.a)(Object(N.a)({},a),{},{children:n?t:Object(m.jsx)(l.a,{to:"./signin"})}))},T=n.p+"static/media/successIcon.1b6082f8.svg",A=n.p+"static/media/errorIcon.df8eddf6.svg";var P=function(e){return Object(m.jsx)("div",{className:"modal modal_type_tooltip ".concat(e.isOpen&&"modal_opened"),children:Object(m.jsxs)("div",{className:"modal__container modal__type_tooltip",children:[Object(m.jsx)("img",{className:"modal__icon",src:e.isRegistered?T:A,alt:"success or error icon"}),Object(m.jsx)("p",{className:"modal__message",children:e.isRegistered?"Success! You have now been registered.":"Oops, something went wrong! Please try again."}),Object(m.jsx)("button",{className:"modal__close-button",type:"button","aria-label":"close button",onClick:e.onClose})]})})},I=function(e){var t=o.a.useState(""),n=Object(r.a)(t,2),a=n[0],c=n[1],i=o.a.useState(""),s=Object(r.a)(i,2),l=s[0],u=s[1];return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(j,{link:"/signin",linkText:"Log in"}),Object(m.jsx)("div",{className:"modal__form_container",children:Object(m.jsxs)("form",{className:"modal__form",onSubmit:function(t){t.preventDefault(),e.handleRegister(a,l)},children:[Object(m.jsx)("h3",{className:"modal__form_heading",children:"Sign up"}),Object(m.jsx)("input",{className:"modal__form_input",placeholder:"Email",type:"email",name:"email",minLength:2,maxLength:200,value:a,onChange:function(e){return c(e.target.value)},required:!0}),Object(m.jsx)("input",{className:"modal__form_input",placeholder:"Password",type:"password",name:"password",minLength:2,maxLength:200,value:l,onChange:function(e){return u(e.target.value)},required:!0}),Object(m.jsx)("button",{className:"modal__form_submit",type:"submit","aria-label":"register",children:"Sign Up"}),Object(m.jsx)(d.b,{className:"modal__link",to:"/signin",children:"Already a member? Log in here!"})]})})]})},U=n(20),E=n(21),w=new(function(){function e(t){var n=t.baseUrl,a=t.headers;Object(U.a)(this,e),this._baseUrl=n,this._headers=a}return Object(E.a)(e,[{key:"_checkResponse",value:function(e){return e.ok?e.json():Promise.reject("Error!"+e.statusText)}},{key:"getInitialCards",value:function(e){return fetch(this._baseUrl+"/cards",{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then(this._checkResponse)}},{key:"getUserInfo",value:function(e){return fetch(this._baseUrl+"/users/me",{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then(this._checkResponse)}},{key:"addCard",value:function(e,t){var n=e.name,a=e.link;return fetch(this._baseUrl+"/cards",{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},method:"POST",body:JSON.stringify({name:n,link:a})}).then(this._checkResponse)}},{key:"deleteCard",value:function(e,t){return fetch(this._baseUrl+"/cards/"+e,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}}).then(this._checkResponse)}},{key:"editProfile",value:function(e,t){var n=e.name,a=e.about;return fetch(this._baseUrl+"/users/me",{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},method:"PATCH",body:JSON.stringify({name:n,about:a})}).then(this._checkResponse)}},{key:"editAvatar",value:function(e,t){var n=e.avatar;return fetch(this._baseUrl+"/users/me/avatar",{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},method:"PATCH",body:JSON.stringify({avatar:n})}).then(this._checkResponse)}},{key:"addLike",value:function(e,t){return fetch(this._baseUrl+"/cards/likes/"+e,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}}).then(this._checkResponse)}},{key:"removeLike",value:function(e,t){return fetch(this._baseUrl+"/cards/likes/"+e,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}}).then(this._checkResponse)}}]),e}())({baseUrl:"https://api.deserie.students.nomoreparties.site"}),D="https://api.deserie.students.nomoreparties.site";function R(e){return e.ok?e.json():Promise.reject("Error!"+e.statusText)}var B=function(){var e=o.a.useState(!1),t=Object(r.a)(e,2),n=t[0],a=t[1],c=o.a.useState(!1),i=Object(r.a)(c,2),u=i[0],d=i[1],b=o.a.useState(!1),f=Object(r.a)(b,2),N=f[0],y=f[1],S=o.a.useState(!1),T=Object(r.a)(S,2),A=T[0],U=T[1],E=o.a.useState(null),B=Object(r.a)(E,2),q=B[0],z=B[1],J=o.a.useState({}),F=Object(r.a)(J,2),H=F[0],Y=F[1],G=o.a.useState([]),M=Object(r.a)(G,2),W=M[0],K=M[1],Q=o.a.useState(),V=Object(r.a)(Q,2),X=V[0],Z=V[1],$=o.a.useState(!1),ee=Object(r.a)($,2),te=ee[0],ne=ee[1],ae=o.a.useState(!1),oe=Object(r.a)(ae,2),ce=oe[0],ie=oe[1],se=o.a.useState(!1),re=Object(r.a)(se,2),le=re[0],ue=re[1],de=o.a.useState(""),me=Object(r.a)(de,2),je=me[0],he=me[1],be=o.a.useState(localStorage.getItem("token")),pe=Object(r.a)(be,2),_e=pe[0],fe=pe[1],Oe=Object(l.g)();function ge(){ue(!0)}function xe(){a(!1),d(!1),y(!1),U(!1),ue(!1),z(null)}function ve(){Oe.push("/signin"),ne(!1),he(""),localStorage.removeItem("token")}return o.a.useEffect((function(){_e&&function(e){return fetch("".concat(D,"/users/me"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){return R(e)})).then((function(e){return e}))}(_e).then((function(e){ne(!0),he(e.user.email),Oe.push("/")})).catch((function(e){console.log(e)}))}),[Oe,_e]),o.a.useEffect((function(){_e&&w.getUserInfo(_e).then((function(e){Y(e.user)})).catch((function(e){console.log(e)}))}),[_e]),o.a.useEffect((function(){_e&&w.getInitialCards(_e).then((function(e){K(e)})).catch((function(e){console.log(e)}))}),[_e]),Object(m.jsx)(h.Provider,{value:H,children:Object(m.jsxs)("div",{className:"root",children:[Object(m.jsxs)(l.d,{children:[Object(m.jsxs)(L,{path:"/main",loggedIn:te,children:[Object(m.jsx)(j,{link:"/signin",linkText:"Log out",email:je,loggedIn:te,onLogOut:ve}),Object(m.jsx)(p,{onLogOut:ve,component:p,onEditAvatarClick:function(){a(!0)},onEditProfileClick:function(){d(!0)},onAddPlaceClick:function(){y(!0)},onCardClick:function(e){z(e)},cards:W,onCardLike:function(e){(e.likes.some((function(e){return e._id===H._id}))?w.removeLike(e._id,_e):w.addLike(e._id,_e)).then((function(t){K((function(n){return n.map((function(n){return n._id===e._id?t:n}))}))})).catch((function(e){console.log(e)}))},onCardDelete:function(e){U(!0),Z(e)},email:je,onClose:xe}),Object(m.jsx)(_,{})]}),Object(m.jsx)(l.b,{path:"/signin",children:Object(m.jsx)(C,{handleLogin:function(e,t){e&&t&&function(e,t){return fetch("".concat(D,"/signin"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return R(e)})).then((function(e){if(e.token)return localStorage.setItem("token",e.token),e})).catch((function(e){return console.log(e)}))}(e,t).then((function(t){t.token&&(localStorage.setItem("token",t.token),fe(t.token),ne(!0),he(e),Oe.push("/main"))})).catch((function(e){console.log(e)}))}})}),Object(m.jsx)(l.b,{path:"/signup",children:Object(m.jsx)(I,{handleRegister:function(e,t){e&&t&&function(e,t){return fetch("".concat(D,"/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return R(e)})).then((function(e){return e})).catch((function(e){return console.log(e)}))}(e,t).then((function(e){e?(ie(!0),ge(),Oe.push("/signin")):(ie(!1),ge())})).then(ge).catch((function(e){ie(!1),ge(),console.log(e)}))}})}),Object(m.jsx)(l.b,{exact:!0,path:"/",children:te?Object(m.jsx)(l.a,{to:"/main"}):Object(m.jsx)(l.a,{to:"/signin"})})]}),Object(m.jsx)(P,{isRegistered:ce,isOpen:le,onClose:xe}),Object(m.jsx)(O,{isOpen:N,onClose:xe,onAddPlace:function(e){var t=e.name,n=e.link;w.addCard({name:t,link:n},_e).then((function(e){K([e.data].concat(Object(s.a)(W))),xe()})).catch((function(e){console.log(e)}))}}),Object(m.jsx)(g,{isOpen:n,onClose:xe,onUpdateAvatar:function(e){var t=e.avatar;w.editAvatar(t,_e).then((function(e){Y(e.data),xe()})).catch((function(e){console.log(e)}))}}),Object(m.jsx)(x,{isOpen:u,onClose:xe,onUpdateUser:function(e){var t=e.name,n=e.about;w.editProfile({name:t,about:n},_e).then((function(e){Y(e.data),xe()})).catch((function(e){console.log(e)}))}}),Object(m.jsx)(v,{cardToDelete:X,isOpen:A,onClose:xe,onSubmit:function(e){w.deleteCard(e,_e).then((function(){K((function(t){return t.filter((function(t){return t._id!==e}))})),xe()})).catch((function(e){console.log(e)}))}}),Object(m.jsx)(k,{card:q,onClose:xe})]})})},q=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,39)).then((function(t){var n=t.getCLS,a=t.getFID,o=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),a(e),o(e),c(e),i(e)}))};i.a.render(Object(m.jsx)(o.a.StrictMode,{children:Object(m.jsx)(d.a,{children:Object(m.jsx)(B,{})})}),document.getElementById("root")),q()}},[[38,1,2]]]);
//# sourceMappingURL=main.1cce2e62.chunk.js.map